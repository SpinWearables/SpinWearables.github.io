<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <link rel="apple-touch-icon-precomposed" href="/colorwheel180.png">
  <link rel="icon" href="/colorwheel196.png">
  <meta property="og:title" content="The SpinWheel" />
  <meta property="og:type" content="website" />
  <meta property="og:description" content="Children have the natural curiosity and capacity to engineer a better world. Our kits just remind them." />
  <meta property="og:image" content="https://spinwearables.com/hanging.jpg" />
  <link rel="image_src" href="https://spinwearables.com/hanging.jpg" />
  <meta name="keywords" content="physical computing, computer science, arduino, programming" />
  <title>Basic Programming Patterns</title>
  <style>
  </style>
  <style>
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="/custom.css" />
  <link rel="stylesheet" href="/custom_book.css" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
<!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//matomo.spinwearables.com/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->
<base target="_blank">
</head>
<body>
<!-- Matomo Image Tracker-->
<noscript><img src="https://matomo.spinwearables.com/matomo.php?idsite=1&amp;rec=1" style="border:0" alt="" /></noscript>
<!-- End Matomo -->
<header>
<div class="nav">
<a href="/">The SpinWheel</a>
<a href="/book">The Field Guide</a>
</div>
<h1 class="title">Basic Programming Patterns</h1>
</header>
<main>
<p>Writing a computer program of your own, whether a desktop app, an interactive website, or the hidden brain of a robot, starts by writing a sequence of instructions in one of the many available computer languages. Some such languages are incredibly complex and picky about the correctness of the written instructions: a small “grammar” error and the computer can not understand what you wanted from it. Other languages are simpler, and even somewhat lenient in the format of the instructions written in them. Using such languages usually requires a more powerful computer, as it takes a lot of resources to teach a computer how to deal with even a fraction of the vagueness and imprecision of human languages.</p>
<p>The vast majority of computer languages do share a number of patterns, just like many human languages share ideas like the distinction between a noun and a verb, or the difference between a word and a sentence. We will describe the most important such patterns in this chapter. We will use a very popular older language that runs well on limited hardware like the SpinWheel’s micro controller. The name of the language is <code>C++</code>.</p>
<h1 id="variables">Variables</h1>
<p>Computer programs do one thing and one thing only: process information. That information can be when a click happened in a game, or the recording of your voice on your phone, or it can be a picture of the road in a self-driving car. Before processing such data, we need a way to instruct the computer to store it in its memory. This is done through <strong>variables</strong>.</p>
<p>For the moment we will discuss only two types of variables: integer numbers and fractions. Integers are easier for the computer to work with, because it does not need to track all the data behind the decimal point. Treating them separately from fractions lets us have faster code, which is especially important for small computers like ours.</p>
<p>To <strong>define</strong> a new integer variable you need the following line in your code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1"></a><span class="dt">int</span> my_special_integer = <span class="dv">6</span>;</span></code></pre></div>
<p>This reserves a cell in the memory of the computer, lets us refer to that cell by the name <code>my_special_integer</code> and stores the value <code>6</code> in it. We can name the variable however we wish as long as it is a single word or multiple words separated with underscores. We usually pick names that tell us something about the purpose of the variable. We can put whatever value we wish as long as it is not too big (bigger than roughly 30 000). There are ways to store bigger numbers too, but they take more memory, which we might not have much off in a small wearable micro computer.</p>
<p>Similarly, if we want to work with fractions, we use the variable type <code>float</code> instead of <code>int</code>. The name comes from the early history of computers and is unimportant for our purposes.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1"></a><span class="dt">float</span> pi = <span class="fl">3.1415</span>;</span></code></pre></div>
<p>Above we stored the number <span class="math inline">\(\pi\)</span> in a variable with the name <code>pi</code>, which would let us use it in other parts of our code if we need to do computations that involve circles.</p>
<h1 id="functions">Functions</h1>
<p>Functions, also known as routines, are commands that take a few variables and do something useful with them. Maybe they compute a new value based on the variables that were given to them and then they provide this value so that we can store it for future use. Or maybe they do something that affects the world around them, like blinking and LED, playing a sounds, or sending a message.</p>
<p>Here is an example of the former, a function called <code>max</code> that takes two numbers and it returns the larger of the two.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1"></a><span class="dt">int</span> number_a = <span class="dv">5</span>;</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="dt">int</span> number_b = <span class="dv">7</span>;</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="dt">int</span> resulting_number = max(number_a, number_b);</span></code></pre></div>
<p>The value stored in <code>resulting_number</code> in this case would be <code>7</code>.</p>
<p>Here is another example where one of the arguments for our function is specified directly, without first being stored in a variable. In this case the value stored in <code>resulting_number</code> will be <code>8</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1"></a><span class="dt">int</span> my_number = <span class="dv">6</span>;</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="dt">int</span> resulting_number = max(my_number, <span class="dv">8</span>);</span></code></pre></div>
<p>As you have seen the typical syntactic rules for the use of a function is to put its arguments inside parenthesis immediately after the name of the function. You might have seen this in math class with trigonometric functions like <span class="math inline">\(\sin{(x)}\)</span> or <span class="math inline">\(\cos{(x)}\)</span>.</p>
<p>We can nest functions and use arithmetic operations as well. For instance, here we will use two more functions, <code>min</code> which returns the smaller of two numbers and <code>sqrt</code> which returns the square root of a given number. Could you explain why the value stored in <code>resulting_number</code> in the following example is <code>4</code>? Here is a hint: <span class="math inline">\(\sqrt{5-1}=\sqrt{4}=2\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1"></a><span class="dt">int</span> number_a = <span class="dv">5</span>;</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="dt">int</span> number_b = <span class="dv">7</span>;</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="dt">int</span> resulting_number = max(sqrt(number_a-<span class="dv">1</span>) * <span class="dv">2</span>, min(number_b, <span class="dv">2</span>));</span></code></pre></div>
<p>Notice that through all of this code we have used the equality sign <code>=</code> to mean “store the value on the right in the memory cell on the left”. This differs from the usual mathematical meaning of the sign, which is usually meant to say “check if the left and right side have the same value”. You can blame early computer scientists and their laziness for the misuse of this sign in most modern programming languages.</p>
<h1 id="creating-your-own-function">Creating your own function</h1>
<p>The programming language would not always have all the functions you might need. A large part of programming is creating your own functions and building interesting complex useful functions out of small simple functions. Here we will give an example of how to write your own function that takes two numbers and it returns their average. If the two numbers are <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, we want to computed <span class="math inline">\(\frac{x+y}{2}\)</span>. We will name the function <code>avg</code>. Let us first write an example of how this function would be used if it already existed:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1"></a><span class="dt">float</span> number_a = <span class="fl">3.5</span>;</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="dt">float</span> number_b = <span class="fl">2.5</span>;</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="dt">float</span> resulting_number = avg(number_a, number_b);</span></code></pre></div>
<p>In this code example <code>resulting_number</code> will have the value of <code>3.0</code>.</p>
<p>To define this new function we need to write down its name, together with the type of data it will be producing and followed by a block of computational instructions:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1"></a><span class="dt">float</span> avg(<span class="dt">float</span> first_argument, <span class="dt">float</span> second_argument) {</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="cf">return</span> <span class="fl">0.5</span>*(first_argument+second_argument);</span>
<span id="cb7-3"><a href="#cb7-3"></a>}</span></code></pre></div>
<p>The very first <code>float</code> in this piece of code is necessary because the computer needs to know what type of values the function will provide (in this case they are fractions). Then we have the name we have picked for our function, namely <code>avg</code>. Then, in parentheses, just as if we are applying the function, we have a list of the arguments the function will be taking. We have to specify their types, so we wrote <code>float</code> to denote working with fractions. We also gave temporary names for these arguments, so that we can refer to them in the expression that is making up the function. In our case, this expression is simply the sum of the two arguments multiplied by one-half. We use the <code>return</code> keyword just in front of this expression, in order to mark it as the result coming from (<strong>returned by</strong>) this function.</p>
<p>We can have multiple sequential instructions inside the block in case the computation is more difficult. That is the purpose of the figure brackets <code>{ }</code> - to separate all the code that defines our function from the rest of the program. For instance, here we will show how to compute the 4th root of a number:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1"></a><span class="dt">float</span> root4(<span class="dt">float</span> x) {</span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="dt">float</span> intermediate_value = sqrt(x);</span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="cf">return</span> sqrt(intermediate_value);</span>
<span id="cb8-4"><a href="#cb8-4"></a>}</span></code></pre></div>
<h1 id="functions-that-do-not-return-values">Functions that do not return values</h1>
<p>Functions are occasionally used to change something in the environment of the device instead of as advanced calculators. Such functions do not return a value and so they do not need any extra variables in which to store their output. One example of such a function would be the <code>delay</code> function that simply pauses the computer for a specified time. The following example will stop everything and wait for 1000 milliseconds which is one second:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1"></a>delay(<span class="dv">1000</span>);</span></code></pre></div>
<p>When creating our own functions of this type, we mark them as <code>void</code>, instead of <code>int</code> or <code>float</code> or something else, to denote that their returned value is void or “empty”. For instance, here we define a function that always pauses the program for exactly half a second:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1"></a><span class="dt">void</span> delay_half_a_second() {</span>
<span id="cb10-2"><a href="#cb10-2"></a>  delay(<span class="dv">500</span>);</span>
<span id="cb10-3"><a href="#cb10-3"></a>}</span></code></pre></div>
<p>Notice how we did not need to use the <code>return</code> keyword. In this particular case we also did not have any parameters in the parentheses that defined our function, but we can very well have such parameters if we wish. For instance, this function takes numbers of seconds as its input and pauses the program for that long (by calculating the number of milliseconds corresponding to the given number of seconds and using the <code>delay</code> function).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1"></a><span class="dt">void</span> delay_seconds(<span class="dt">int</span> number_of_seconds) {</span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="dt">int</span> number_of_milliseconds = <span class="dv">1000</span> * number_of_seconds;</span>
<span id="cb11-3"><a href="#cb11-3"></a>  delay(number_of_milliseconds);</span>
<span id="cb11-4"><a href="#cb11-4"></a>}</span></code></pre></div>
<h1 id="comments">Comments</h1>
<p>As the code we write grows more and more, it helps to add notes in the code to ourselves and our friends. That way it is easier to understand the purpose of the code when we look at it again in the future. Such notes are usually called “comments”, and they are completely neglected by the computer. In the language we are using they are denoted by a double slash <code>//</code> – everything to the right of these symbols, until the end of the line, is a message for fellow humans. We will use such comments below in some more complicated examples of code.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">// I am writing this comment to remind me that the next</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">// line stores the number 5 in the variable named my_test_variable.</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="dt">int</span> my_test_variable = <span class="dv">5</span>;</span></code></pre></div>
<h1 id="the-first-function-to-run-when-a-program-starts">The first function to run when a program starts</h1>
<p>After we have created all the variables we will need and all of our special functions that will help us do what we want, we need to actually start the program. But the program needs to know what to run first. In different languages this is done differently, but in our particular case we do it by defining two special functions: <code>setup</code> and <code>loop</code>. Our computer is instructed to run these functions first: It looks at the <code>setup</code> function and runs it first, before anything else. Usually this function is used to <strong>set up</strong> any settings we might need in advance. Then the computer repeatedly runs the <code>loop</code> function, which is named this way exactly because it <strong>runs in a loop</strong>.</p>
<p>Here is a large example that includes all these features. It will use the <code>Serial.println()</code> function in order to send messages to the computer.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">// First we define a convenient pausing function</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">// that waits a given number of seconds</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="dt">void</span> delay_seconds(<span class="dt">int</span> number_of_seconds) {</span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="dt">int</span> number_of_milliseconds = <span class="dv">1000</span> * number_of_seconds;</span>
<span id="cb13-5"><a href="#cb13-5"></a>  delay(number_of_milliseconds);</span>
<span id="cb13-6"><a href="#cb13-6"></a>}</span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">// This is the setup function that will automatically run</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">// first when the device starts.</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="dt">void</span> setup() {</span>
<span id="cb13-12"><a href="#cb13-12"></a>  <span class="co">// The next line ensures that the communication hardware</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>  <span class="co">// on our device is ready to send messages.</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>  <span class="co">// The name &quot;Serial&quot; is such for historical reasons</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>  <span class="co">// (it is the name for this type of communication).</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>  Serial.begin(<span class="dv">9600</span>); <span class="co">// The 9600 is the speed of the conection.</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>}</span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">// Define a variable in which we will store a counter that goes up by one on</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">// each step.</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="dt">int</span> counter = <span class="dv">1</span>;</span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">// This function runs repeatedly after the setup function finishes.</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="dt">void</span> loop() {</span>
<span id="cb13-25"><a href="#cb13-25"></a>  <span class="co">// Send a message to the connected computer.</span></span>
<span id="cb13-26"><a href="#cb13-26"></a>  <span class="co">// The message will just be the value of the counter.</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>  Serial.println(counter);</span>
<span id="cb13-28"><a href="#cb13-28"></a>  <span class="co">// Increment the value of the counter.</span></span>
<span id="cb13-29"><a href="#cb13-29"></a>  counter = counter + <span class="dv">1</span>;</span>
<span id="cb13-30"><a href="#cb13-30"></a>  <span class="co">// Wait for a second before you start the loop function again.</span></span>
<span id="cb13-31"><a href="#cb13-31"></a>  delay_seconds(<span class="dv">1</span>);</span>
<span id="cb13-32"><a href="#cb13-32"></a>}</span></code></pre></div>
<div class="further-reading">
<p>The Arduino community has very detailed resources on the programming language that we are using. You can start with their <a href="https://www.arduino.cc/en/Tutorial/Foundations">tutorial</a> for instance.</p>
</div>
<script data-isso="//comments.spinwearables.com/"
data-isso-reply-to-self="false"
data-isso-require-author="true"
data-isso-require-email="true"
data-isso-avatar="false"
data-isso-vote="false"
src="//comments.spinwearables.com/js/embed.min.js"></script>
<section id="isso-thread"></section>
<script>
document.querySelector("#isso-thread").addEventListener(
  "click",
  function () {
    document.querySelectorAll("#isso-thread > div").forEach(function (x) {x.style.display = "block";});
  });
</script>
</main>
<div id="license">
<!--<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/cc-by-sa.png" /></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.-->
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/cc-by-nc-sa.png" /></a></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>. © SpinWearables LLC (<a href="/license">license and trademark details</a>)
</div>
</body>
</html>
