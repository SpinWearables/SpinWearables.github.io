<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Grand_Finale.ino</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="/custom.css" type="text/css" />
<style>
h1, h2, h3 {
  margin: auto;
}
.flex-container {
  padding: 1rem;
  margin: auto;
  max-width: 1400px;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}
.wide-text {
  flex: 0 1 900px;
  margin: auto;
}
.side-text, .code {
  flex: 0 0 40%;
  padding: 0 1em;
  overflow-x: scroll;
  scrollbar-width: thin;
}
@media all and (max-width: 900px) {
.flex-container > * {
  flex: 1 0 100%;
}
}
img {
  max-width: 100%;
}
video {
  max-width: 100%;
}
.wide-text video {
  max-width: 300px;
  margin: auto;
  display: block;
}
.code {
  background-color: rgba(116, 116, 116, 0.40);
}
.code > .sourceCode {
  overflow: unset;
}
</style>
</head>
<body>
<p style="font-size:0.75rem;text-align:center;margin:0;">
The code presented on this page can be <a href="./Grand_Finale.ino">downloaded</a> or found in the Arduino examples menu under <code>Examples → SpinWearables → Dancing_with_Color → Grand_Finale</code>.
</p>
<div class="flex-container">
<section id="dancing-with-color-have-the-spinwheel-respond-to-both-acceleration-and-rotation." class="wide-text">
<h1>Dancing with Color: Have the SpinWheel respond to both acceleration and rotation.</h1>
<p>Here we include one final code example. This example is designed to be more complex than the previous examples and to inspire future work. For more information and other examples, refer to the <a href="https://spinwearables.com/dancing/">dancing companion page</a>.</p>
</section>
<div class="side-text">

</div>
<div class="code">
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"></code></pre></div>
</div>
<div class="side-text">
<p>These include statements should look familiar! As a reminder, they allow the program to access coding tools for the SpinWheel.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1"></a><span class="pp">#include </span><span class="im">&quot;SpinWearables.h&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">using</span> <span class="kw">namespace</span> SpinWearables;</span></code></pre></div>
</div>
<div class="side-text">
<p>The setup function should also seem familiar. As a reminder, the <code>setup</code> function is run once when the SpinWheel turns on. Also, <code>SpinWheel.begin()</code> prepares the LED to accept new colors.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1"></a><span class="dt">void</span> setup() {</span>
<span id="cb3-2"><a href="#cb3-2"></a>  SpinWheel.begin();</span>
<span id="cb3-3"><a href="#cb3-3"></a>}</span></code></pre></div>
</div>
<div class="side-text">
<p>Here, we initialize some variables that we will make use of later.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1"></a><span class="dt">int</span> offset = <span class="dv">0</span>;</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="dt">int</span> colorChange;</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="dt">uint8_t</span> angle = <span class="dv">0</span>; </span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="dt">int</span> a_cum = <span class="dv">0</span>;</span></code></pre></div>
</div>
<div class="side-text">
<p>Instructions in a loop function are repeated over and over again, in other words, “in a loop”.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1"></a><span class="dt">void</span> loop() {</span></code></pre></div>
</div>
<div class="side-text">
<p>The <code>readIMU</code> function checks if the sensor is ready and takes its current rotation data.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1"></a>  SpinWheel.readIMU();</span></code></pre></div>
</div>
<div class="side-text">
<p>First, we can add a “motion_snake” like in the previous sketch.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1"></a>  <span class="cf">if</span> (abs(SpinWheel.gx) &gt; <span class="dv">50</span>) {</span>
<span id="cb7-2"><a href="#cb7-2"></a>     <span class="co">// add 10 to make it spin at a reasonable speed</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>     angle = angle+<span class="dv">10</span>;</span>
<span id="cb7-4"><a href="#cb7-4"></a>     SpinWheel.setSmallLEDsPointer(angle, <span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>);</span>
<span id="cb7-5"><a href="#cb7-5"></a>  }</span></code></pre></div>
</div>
<div class="side-text">
<p>Rather than having the color of the large LEDs change based on the SpinWheel’s angular velocity, instead we can have the color change when the acceleration of the SpinWheel is sufficient.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1"></a>  <span class="dt">int</span> a = abs(SpinWheel.ax);</span></code></pre></div>
</div>
<div class="side-text">
<p>Like r_cum in the Rainbow_Chase_Advanced sketch, a_cum is the sum of the SpinWheel’s acceleration in the x direction. We multiply the acceleration by 10 to have the color change be noticeable. We did a similar thing in the snake example.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1"></a>  a_cum = a*<span class="dv">10</span> + a_cum;</span></code></pre></div>
</div>
<div class="side-text">
<p>We will have some fixed “delay” between the numbers controlling each LED’s color. Change this number! What happens?</p>
</div>
<div class="code">
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1"></a>  <span class="dt">int</span> a_delay = <span class="dv">15</span>;</span></code></pre></div>
</div>
<div class="side-text">
<p>We will have the inner and outer large LEDs light up the same color. The color of each pair will be governed by a slightly modified number.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1"></a>  <span class="dt">int</span> a0 = a_cum % <span class="dv">255</span>;</span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="dt">int</span> a1 = (a_cum+a_delay) % <span class="dv">255</span>;</span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="dt">int</span> a2 = (a_cum+<span class="dv">2</span>*a_delay) % <span class="dv">255</span>;</span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="dt">int</span> a3 = (a_cum+<span class="dv">3</span>*a_delay) % <span class="dv">255</span>;</span></code></pre></div>
</div>
<div class="side-text">
<p>Here we finally set those colors.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb12"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1"></a>  SpinWheel.setLargeLED(<span class="dv">0</span>, colorWheel(a0));</span>
<span id="cb12-2"><a href="#cb12-2"></a>  SpinWheel.setLargeLED(<span class="dv">1</span>, colorWheel(a1));</span>
<span id="cb12-3"><a href="#cb12-3"></a>  SpinWheel.setLargeLED(<span class="dv">2</span>, colorWheel(a2));</span>
<span id="cb12-4"><a href="#cb12-4"></a>  SpinWheel.setLargeLED(<span class="dv">3</span>, colorWheel(a3));</span>
<span id="cb12-5"><a href="#cb12-5"></a>  SpinWheel.setLargeLED(<span class="dv">4</span>, colorWheel(a0));</span>
<span id="cb12-6"><a href="#cb12-6"></a>  SpinWheel.setLargeLED(<span class="dv">5</span>, colorWheel(a1));</span>
<span id="cb12-7"><a href="#cb12-7"></a>  SpinWheel.setLargeLED(<span class="dv">6</span>, colorWheel(a2));</span>
<span id="cb12-8"><a href="#cb12-8"></a>  SpinWheel.setLargeLED(<span class="dv">7</span>, colorWheel(a3));</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a>  </span></code></pre></div>
</div>
<div class="side-text">
<p>Have the SpinWheel display the desired pattern.</p>
</div>
<div class="code">
<div class="sourceCode" id="cb13"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1"></a>  SpinWheel.drawFrame();</span>
<span id="cb13-2"><a href="#cb13-2"></a>}</span></code></pre></div>
</div>
</div>
</body>
</html>
